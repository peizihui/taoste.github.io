秋叶Excel：[心态崩了，老板让我把1000多个文件重命名(Excel + CMD)……](https://mp.weixin.qq.com/s/yEJLm_Z2v5CNdPLiHcxJbA)
( 原创： 无敌  秋叶Excel  2018年12月21日 )

-----------------------------------------------

- CMD 批处理命令 : **批量重命名文件（REN 命令）**

步骤很简单，写公式 → 复制粘贴到记事本 → 存储为 BAT 文件 → 执行批处理文件 → 完成。


这里需要用到  REN 命令，命令格式如下：

REN "原文件名" "新文件名"

示例：
="REN """&A2&""" """&B2&""""

利用这个公式批量化生成重命名命令语句之后，把这个语句复制到记事本当中，另存为 BAT 批处理文件，执行这个文件，就可以实现批量化的重命名啦！

-----------------------------------------------

- CMD 批处理命令 : **提取文件列表（DIR 命令）**

格式如下：

DIR /B "路径\文件类型"> 文件列表 .csv

示例：
DIR /B "D:\桌面\*.XLS*"> 文件列表 .csv

文件路径外部有一对半角的双引号。命令最后的「文件列表 .csv」指的就是最终存放这份清单的 CSV 文件，CSV 文件可以直接用 Excel 打开，里面会自动以表格形式显示所有导入的文件名称。

如果还需要提取目录中所有子目录下的文件，操作也非常简单，只需要添加一个 /S 参数，命令语句变成：

DIR /B /S "路径\文件类型"> 文件列表 .csv

-----------------------------------------------

- CMD 批处理命令 : **批量建立目录（MD 命令）**

当我们想批量建立一堆目录，比如建立 2018 年 12 个月的文件夹，需要用到 MD 命令，命令格式如下：

MD "目录名称"

我们只需要把要创建的目录名称放置在表格的 A 列当中，使用下面的公式生成一组建立目录的命令：

="MD """&A2&""""

再把命令语句复制到记事本中，另存为 BAT 批处理文件，执行这个文件，就可以实现批量建立目录啦！

-----------------------------------------------

再啰嗦几句，其实下面才是重点，否则命令很可能会失败哦！

❶ 使用 CMD 批处理命令时，当文件名或路径中有空格时，一定要用半角的双引号包起来。这也是上面三个命令中，都加了双引号的原因。

总之，为了稳妥，不管路径中有没有空格，都建议都加上双引号，记住是半角的哦！

❷ 在使用 CMD 命令时，注意命令与参数之间、参数与参数之间需要用空格分隔，例如下面这条命令中就包含了两处空格：

REN "原文件名" "新文件名"

❸ 大家可能还会碰到一个问题，就是把TXT记事本文件改为BAT文件时，发现改了文件名，图标还是原来TXT的样式，没有变成BAT格式的。

这是因为没有改对文件的扩展名，有些时候系统是隐藏文件扩展名的。需要先显示出扩展名，再更改成BAT才是有效的。

嫌麻烦的小伙伴也可以直接在文件夹选项中取消「隐藏已知文件类型的扩展名」的勾选，强制显示文件扩展名。
